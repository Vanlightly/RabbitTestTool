name: identical-systems-unique-workloads
systems:
  - name: s1
    base: ec2/standard-8-vcpu-latest.yml
    hardware:
      rabbitmq-instance:
        volume-config: 1-gp2-200
    run: 1
  - name: s2
    base: ec2/standard-8-vcpu-latest.yml
    hardware:
      rabbitmq-instance:
        volume-config: 1-gp2-200
    run: 1
common:
  workload:
    topology:
      file: point-to-point/point-to-point-safe.yml
      variables:
        queues: 1
        consumers: 1
    policies:
      file: mirrored-queue.yml
      variables:
        ha-mode: exactly
        ha-params: 2
    #network:
    #rabbit:
    # configuration:
benchmarks:
  - benchmark:
      - workload:
          topology:
            variables:
              publishers: 1
              scale-type: multi-vhost
        systems:
          - s1
      - workload:
          topology:
            variables:
              publishers: 1
              scale-type: single-vhost
        systems:
          - s2
  - benchmark:
      - workload:
          topology:
            variables:
              publishers: 2
              scale-type: multi-vhost
        systems:
          - s1
      - workload:
          topology:
            variables:
              publishers: 2
              scale-type: single-vhost
        systems:
          - s2
  - benchmark:
      - workload:
          topology:
            variables:
              publishers: 4
              scale-type: multi-vhost
        systems:
          - s1
      - workload:
          topology:
            variables:
              publishers: 4
              scale-type: single-vhost
        systems:
          - s2
  - benchmark:
      - workload:
          topology:
            variables:
              publishers: 8
              scale-type: multi-vhost
        systems:
          - s1
      - workload:
          topology:
            variables:
              publishers: 8
              scale-type: single-vhost
        systems:
          - s2